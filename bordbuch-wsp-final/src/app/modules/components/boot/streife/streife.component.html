<!-- <div class="absolute flex flex-row justify-between items-center w-full h-16 px-3 text-gray-800 shadow-lg z-20">
  <a class="w-8 h-8 rotate-180 cursor-pointer" (click)="logout()">
    <icons class="w-8 h-8 stroke-1 stroke-current" name="logout"></icons>
  </a>
  <span class="text-2xl text-gray-800">{{ name }}</span>
  <a class="w-8 h-8 cursor-pointer" *ngIf="!isPatrolActive$" (click)="startPatrol()">
    <icons class="w-8 h-8 stroke-1 stroke-current" name="chevron-right"></icons>
  </a>
  <div class="flex flex-row justify-end items-center w-24">
    <a class="w-8 h-8 ml-4 cursor-pointer" [routerLink]="['map']" *ngIf="isPatrolActive$">
      <icons class="w-8 h-8 stroke-1 stroke-current" name="map"></icons>
    </a>
    <a class="w-8 h-8 ml-4 cursor-pointer" [routerLink]="['positions']" *ngIf="isPatrolActive$">
      <icons class="w-8 h-8 stroke-1 stroke-current" name="table"></icons>
    </a>
  </div>
</div> -->

<tabbar class="shadow-lg z-50" [tabs]="list" labelField="username" [active]="active" (onTabSelect)="changeTab($event)">
  <div class="flex w-full">
    <button class="p-2 px-4 bg-gray-100 hover:bg-gray-200 font-medium shadow-inner rounded-l-lg" (click)="previous(headlineStepper)">Zurück</button>
    <button class="p-2 px-4 bg-gray-100 hover:bg-gray-200 font-medium shadow-inner rounded-r-lg" (click)="next(headlineStepper)">Weiter</button>
    <!-- <button class="w-8 h-8 ml-4 cursor-pointer" *ngIf="!(isPatrolActive$ | async)" (click)="initializePatrol()">
      <icons class="w-8 h-8 stroke-1 stroke-current text-black" name="add"></icons>
    </button> -->
    <!-- <button class="w-8 h-8 ml-4 cursor-pointer" (click)="deletePatrol()">
      <icons class="w-8 h-8 stroke-1 stroke-current text-black" name="trash"></icons>
    </button> -->
    <button *ngIf="(patrolStatus$ | async)=='beendet'" class="flex-grow ml-4 p-2 px-8 bg-gray-100 text-gray-400 font-medium shadow-inner rounded-lg" (click)="initializePatrol()">Streife erstellen</button>
    <button *ngIf="(patrolStatus$ | async)=='in Vorbereitung'" class="flex-grow ml-4 p-2 px-8 bg-gray-100 text-gray-400 font-medium shadow-inner rounded-lg" (click)="updatePatrol('aktiv')">Streife starten</button>
    <button *ngIf="(patrolStatus$ | async)=='aktiv'" class="flex-grow ml-4 p-2 px-8 bg-gray-100 text-gray-400 font-medium shadow-inner rounded-lg" (click)="updatePatrol('beendet')" disabled>Streife beenden</button>
  </div>
</tabbar>
  
  <div class="content">
    <form [formGroup]="zweckFormGroup">
      <headline-stepper [linear]="isLinear" [status]="patrolStatus$ | async" #headlineStepper>
        <cdk-step [editable]="isEditable" [optional]="false" [stepControl]="zweckFormGroup.get('kennung')!">
          <ng-template cdkStepLabel>
            <div class="ml-5">
              <h4 class="text-2xl text-blue-600">Streife</h4>
              <p class="text-lg text-gray-600">Next: <button type="submit" class="cursor-pointer" cdkStepperNext>Besatzung</button></p>
            </div>
          </ng-template>
          <div class="w-full mt-10 bg-white hover:bg-gray-50 rounded-lg shadow-lg">
            <div class="flex flex-row p-4 justify-between border-b">
              <div>
                <h2 class="text-2xl ">Streife</h2>
                <p class="text-sm text-gray-500">
                  Die Streife ist {{ patrolStatus$ | async }}.
                </p>
              </div>
              <div>
                <button class="w-8 h-8 m-2 cursor-pointer" (click)="deletePatrol()">
                  <icons class="w-8 h-8 stroke-1 stroke-current text-gray-500" name="trash"></icons>
                </button>
              </div>
            </div>
            <div class="p-4">
              <mat-form-field appearance="fill">
                <mat-label>Kennung</mat-label>
                <mat-select formControlName="kennung" [disabled]="(patrolStatus$ | async)!='in Vorbereitung'">
                  <mat-option *ngFor="let kennung of kennungen" [value]="kennung.bezeichnung">
                    {{ kennung.bezeichnung }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field appearance="fill">
                <mat-label>Fahrtzweck</mat-label>
                <mat-select formControlName="zweck" [disabled]="(patrolStatus$ | async)!='in Vorbereitung'">
                  <mat-option *ngFor="let zweck of zwecke" [value]="zweck.bezeichnung">
                    {{ zweck.bezeichnung }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </cdk-step>
        <cdk-step [editable]="isEditable" [optional]="false">
          <ng-template cdkStepLabel>
            <div class="ml-5">
              <h4 class="text-2xl text-blue-600">Besatzung</h4>
              <p class="text-lg text-gray-600">Folgend: <button type="submit" class="cursor-pointer" cdkStepperNext>Zählerstände</button></p>
            </div>
          </ng-template>
          <div class="w-full mt-10 bg-white hover:bg-gray-50 rounded-lg p-2 shadow-lg">
            <div class="md:space-y-0 space-y-1 p-4">
              <div class="flex flex-wrap">
                <div class="box blue w-64 rounded-lg shadow-md" *ngFor="let mitglied of besatzung$ | async" (click)="openBesatzungModal(mitglied.id)">
                  <h2>{{ mitglied.funktion }}</h2>
                  <div class="grid grid-cols-2">
                    <p class="text-gray-600 mr-2">
                      Name
                    </p>
                    <p>
                      {{ mitglied.name }}
                    </p>
                  </div>
                  <div class="grid grid-cols-2">
                    <p class="text-gray-600 mr-2">
                      Pers.-Nr.
                    </p>
                    <p>
                      {{ mitglied.persnr }}
                    </p>
                  </div>
                  <div class="grid grid-cols-2">
                    <p class="text-gray-600 mr-2">
                      an Bord
                    </p>
                    <p>
                      {{ mitglied.an_bord }}
                    </p>
                  </div>
  
                  <div class="grid grid-cols-2">
                    <p class="text-gray-600 mr-2">
                      von Bord
                    </p>
                    <p>
                      {{ mitglied.von_bord }}
                    </p>
                  </div>
                </div>
                <div class="box blue w-64 placeholder border border-gray-100 grid justify-center items-center" (click)="openBesatzungModal()">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </cdk-step>
        <cdk-step [editable]="isEditable" [optional]="false">
          <ng-template cdkStepLabel>
            <div class="ml-5">
              <h4 class="text-2xl text-blue-600">Zählerstände</h4>
              <p class="text-lg text-gray-600">Folgend: <button type="submit" class="cursor-pointer" cdkStepperNext>Prüfvermerke</button></p>
            </div>
          </ng-template>
          <div class="w-full mt-10 bg-white hover:bg-gray-50 rounded-lg p-2 shadow-lg">
            <p class="text-xl font-semibold text-gray-500">Zählerstände</p>
            <div class="line">
              <app-card class="lineelement w-80 h-40 mr-3" [flippable]="false" *ngFor="let zaehlerstand of zaehlerstaende$ | async; index as index" (click)=openZaehlerstandModal(zaehlerstand.id)>
                <ng-container CardSimple>
                  <div class="m-4">
                    <div class="text-xl font-semibold leading-tight">{{ zaehlerstand.zaehlerstandstyp }}</div>
                    <div class="grid grid-cols-3 gap-2 mt-4">
                      <div>Value:</div>
                      <div class="col-span-2">{{ zaehlerstand.value }}</div>
                      <div>Aktualisiert:</div>
                      <div class="col-span-2 text-gray-500">{{ zaehlerstand.date }}</div>
                    </div>
                  </div>
                </ng-container>
              </app-card>
            </div>
          </div>
        </cdk-step>
        <cdk-step [editable]="isEditable" [optional]="false">
          <ng-template cdkStepLabel>
            <div class="ml-5">
              <h4 class="text-2xl text-blue-600">Prüfvermerke</h4>
              <p class="text-lg text-gray-600">Folgend: <button type="submit" class="cursor-pointer" cdkStepperNext>Betankung</button></p>
            </div>
          </ng-template>
          <div class="w-full mt-10 bg-white hover:bg-gray-50 rounded-lg p-2 shadow-lg">
            <p class="text-xl font-semibold leading-tight text-gray-500">Gefertigte Prüfvermerke</p>
              <div class="line">
                <app-card class="lineelement w-80 h-40 mr-3" [flippable]="true" [face]="'front'" #flippableCard="card" *ngFor="let reparatur of reparaturen$ | async; index as index" (click)="flippableCard.face = flippableCard.face === 'front' ? 'back' : 'front'">
                  <ng-container CardFront>
                    <div class="m-4">
                      <div class="text-xl font-semibold leading-tight">{{ reparatur.item }}</div>
                      <div class="mt-4 text-gray-500">{{ reparatur.description }}</div>
                    </div>
                  </ng-container>
                  <ng-container CardBack>
                    <div class="m-4">
                      <div class="text-xl font-semibold leading-tight">{{ reparatur.item }}</div>
                      <div class="grid grid-cols-3 gap-2 mt-4">
                        <div>Kategorie:</div>
                        <div class="col-span-2">{{ reparatur.kategorie }}</div>
                        <div>Status:</div>
                        <div class="col-span-2">{{ reparatur.status }}</div>
                        <div>Erstellt:</div>
                        <div class="col-span-2 text-gray-500">{{ reparatur.date }}</div>
                      </div>
                    </div>
                  </ng-container>
                </app-card>
                <app-card class="lineelement w-80 h-40 mr-3" (click)="openPruefvermerkModal()">
                  <ng-container CardSimple>
                    <div class="m-4">
                      <div class="text-xl font-semibold leading-tight">Prüfvermerk erstellen</div>
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 4v16m8-8H4" />
                      </svg>
                    </div>
                  </ng-container>
                </app-card>
              </div>
            </div>
          </cdk-step>
          <cdk-step [editable]="isEditable" [optional]="false">
            <ng-template cdkStepLabel>
              <div class="ml-5">
                <h4 class="text-2xl text-blue-600">Betankung</h4>
                <p class="text-lg text-gray-600">Folgend: <button type="submit" class="cursor-pointer" cdkStepperNext>Kontrolle der Eingaben</button></p>
              </div>
            </ng-template>
            <div class="w-full mt-10 bg-white hover:bg-gray-50 rounded-lg p-2 shadow-lg">
              <p class="text-xl font-semibold leading-tight text-gray-500">Letzter Tankzettel</p>
              <div class="line">
                <app-card class="lineelement w-80 h-40 mr-3" [flippable]="true" [face]="'front'" #flippableCard="card" *ngFor="let betankung of betankungen$ | async; index as index" (click)="flippableCard.face = flippableCard.face === 'front' ? 'back' : 'front'">
                  <ng-container CardFront>
                    <div class="m-4">
                      <div class="text-xl font-semibold leading-tight">{{ betankung.fuel }}</div>
                      <div class="grid grid-cols-3 gap-2 mt-4">
                        <div>Menge (in L):</div>
                        <div class="col-span-2">{{ betankung.fuelfillingquantity }}</div>
                        <div>Erstellt:</div>
                        <div class="col-span-2 text-gray-500">{{ betankung.date }}</div>
                      </div>
                    </div>
                  </ng-container>
                  <ng-container CardBack>
                    <div class="m-4">
                      <div class="text-xl font-semibold leading-tight">{{ betankung.fuel }}</div>
                      <div class="grid grid-cols-3 gap-2 mt-4">
                        <div>Ort:</div>
                        <div class="col-span-2">{{ betankung.ort }}</div>
                        <div>Erstellt:</div>
                        <div class="col-span-2 text-gray-500">{{ betankung.date }}</div>
                      </div>
                    </div>
                  </ng-container>
                </app-card>
                <app-card class="lineelement w-80 h-40 mr-3" (click)="openBetankungModal()">
                  <ng-container CardSimple>
                    <div class="m-4">
                      <div class="text-xl font-semibold leading-tight">Betankung durchführen</div>
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 4v16m8-8H4" />
                      </svg>
                    </div>
                  </ng-container>
                </app-card>
              </div>
          </div>
        </cdk-step>
        <cdk-step [editable]="isEditable" [optional]="false">
          <ng-template cdkStepLabel>
            <div class="ml-5">
              <h4 class="text-2xl text-blue-600">Kontrolle der Eingaben</h4>
            </div>
          </ng-template>
          <div class="w-full bg-white hover:bg-gray-50 rounded-lg p-2 shadow-lg">

          </div>
        </cdk-step>
      </headline-stepper>
    </form>
  </div>
  <!-- <div *ngIf="checkFormGroup.value.check" class="absolute flex bottom-0 h-20 w-full rounded-t-xl bg-gray-100 drop-shadow-xl">
    <button class="p-3 mt-3 mx-3 w-full h-12 bg-green-800 text-white rounded-md shadow-lg" mat-button>Streife starten</button>
    <button class="p-3 mt-3 mx-3 w-full h-12 bg-gray-600 text-white rounded-md shadow-lg" mat-button>Streife beenden</button>
  </div> -->